name: Daily Commit Link and POTD Badge Tracker

on:
  push:
    branches:
      - main  # or your default branch name
  workflow_dispatch:

jobs:
  update-link:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Get Current Commit Link
        id: commit-link
        run: |
          echo "Commit URL: https://github.com/${{ github.repository }}/commit/${{ github.sha }}"
          echo "Commit URL: https://github.com/${{ github.repository }}/commit/${{ github.sha }}" > commit-link.txt

      - name: Update README with the Latest Commit
        run: |
          COMMIT_LINK=$(cat commit-link.txt)
          sed -i "s|<!--START_SECTION:latest-commit-->.*<!--END_SECTION:latest-commit-->|<!--START_SECTION:latest-commit-->$COMMIT_LINK<!--END_SECTION:latest-commit-->|" README.md

      - name: Add Today's Solution Badge
        run: |
          # Example badge URL: Customize it for the actual solution
          BADGE_URL="https://img.shields.io/badge/GeeksforGeeks-Solution%20of%20the%20Day-blue"
          BADGE_LINK="[![Today's POTD Solution]($BADGE_URL)](https://github.com/Hunterdii/GeeksforGeeks-POTD)"
          # Add the badge link to the README
          sed -i "s|<!--START_SECTION:potd-badge-->.*<!--END_SECTION:potd-badge-->|<!--START_SECTION:potd-badge-->$BADGE_LINK<!--END_SECTION:potd-badge-->|" README.md

      - name: Commit and Push Changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add README.md
          git diff-index --quiet HEAD || git commit -m "Update commit link and POTD badge"
          git push
